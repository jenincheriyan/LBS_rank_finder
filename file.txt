This is the final merge version